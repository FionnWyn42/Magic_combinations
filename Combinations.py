physical_elements = {
    "Fire": "red",
    "Water": "blue",
    "Earth": "saddlebrown",
    "Air": "skyblue",
    "Metal": "lightgray",
    "Crystal": "cyan",
    "Ice": "lightblue",
    "Lightning": "gold",
    "Steam": "gainsboro",
    "Magma": "tomato",
    "Shadow": "dimgray",
    "Wood": "peru",
    "Stone": "sienna",
    "Sand": "tan",
    "Ash": "darkgray",
    "Smoke": "slategray",
    "Lava": "orangered",
    "Obsidian": "black",
    "Flame": "darkorange",
    "Snow": "mintcream",
    "Glass": "lavender",
    "Clay": "rosybrown",
    "Mud": "burlywood",
    "Salt": "ghostwhite",
    "Iron": "silver",
    "Steel": "lightsteelblue",
    "Copper": "chocolate",
    "Bronze": "darkgoldenrod",
    "Lead": "gray",
    "Gold": "gold",
    "Silver": "lightgray",
    "Platinum": "whitesmoke",
    "Diamond": "aliceblue",
    "Pearl": "ivory",
    "Coal": "black",
    "Sulfur": "khaki",
    "Blood": "darkred",
    "Quicksilver": "lightblue",
    "Ether": "blueviolet",
    "Star": "lightyellow",
    "Sun": "goldenrod",
    "Moon": "lightgray",
    "Galaxy": "midnightblue",
    "Nebula": "mediumpurple",
    "Plasma": "deeppink",
    "Dust": "navajowhite",
    "Fog": "lightgray",
    "Mist": "honeydew",
    "Gale": "lightcyan",
    "Tide": "steelblue",
    "Current": "cornflowerblue",
    "Whirlwind": "lightblue",
    "Tornado": "slategray",
    "Quake": "tan",
    "Boulder": "brown",
    "Rock": "saddlebrown",
    "Spark": "orange",
    "Pulse": "hotpink",
    "Drift": "beige",
    "Haze": "seashell",
    "Frost": "powderblue",
    "Glacier": "azure",
    "Storm": "lightslategray",
    "Meteor": "darkslategray",
    "Asteroid": "gray",
    "Comet": "lavenderblush",
    "Volcano": "firebrick",
    "Cinder": "dimgrey",
    "Wave": "dodgerblue",
    "Rain": "paleturquoise",
    "Bubble": "lightcyan",
    "Mudslide": "peru",
    "Pebble": "wheat",
    "Crater": "lightgoldenrodyellow",
    "Thermal": "orange",
    "Aurora": "orchid",
    "Smokecloud": "lightgray",
    "Ember": "indianred",
    "Blizzard": "lightsteelblue",
    "Icicle": "lightcyan",
    "Shale": "slategray",
    "Echo": "silver",
    "Wisp": "aliceblue",
    "Beam": "lightyellow",
    "Root": "darkolivegreen",
    "Petal": "pink",
    "Seed": "yellowgreen",
    "Branch": "sienna",
    "Thorn": "darkseagreen",
    "Vine": "olivedrab",
    "Bark": "saddlebrown",
    "Sap": "goldenrod",
    "Pollen": "lemonchiffon",
    "Field": "mediumseagreen",
    "Forest": "darkgreen",
    "Jungle": "green",
    "River": "deepskyblue",
    "Lake": "royalblue",
    "Ocean": "teal",
    "Cave": "dimgray",
    "Tundra": "lightblue",
    "Savanna": "darkkhaki",
    "Desert": "moccasin",
    "Marsh": "olive",
    "Reef": "mediumaquamarine"
}

conceptual_elements = {
    "Hope": "honeydew",
    "Fear": "dimgray",
    "Love": "pink",
    "Hate": "maroon",
    "Peace": "lightgreen",
    "War": "crimson",
    "Truth": "ivory",
    "Lies": "darkslategray",
    "Order": "beige",
    "Chaos": "orchid",
    "Joy": "gold",
    "Sorrow": "slateblue",
    "Wisdom": "cornsilk",
    "Ignorance": "lightgray",
    "Faith": "linen",
    "Doubt": "darkgray",
    "Honor": "navajowhite",
    "Betrayal": "firebrick",
    "Freedom": "skyblue",
    "Control": "gray",
    "Justice": "lightsteelblue",
    "Corruption": "darkmagenta",
    "Patience": "mintcream",
    "Anger": "indianred",
    "Kindness": "lightpink",
    "Jealousy": "yellowgreen",
    "Greed": "darkseagreen",
    "Pride": "mediumorchid",
    "Humility": "ghostwhite",
    "Dream": "thistle",
    "Nightmare": "black",
    "Memory": "mistyrose",
    "Amnesia": "slategrey",
    "Unity": "lightyellow",
    "Division": "purple",
    "Compassion": "lightcoral",
    "Apathy": "lightslategrey",
    "Logic": "lightblue",
    "Emotion": "deeppink",
    "Science": "steelblue",
    "Magic": "blueviolet",
    "Time": "darkgray",
    "Eternity": "azure",
    "Mortality": "darkred",
    "Immortality": "lavender",
    "Purpose": "khaki",
    "Despair": "darkslateblue",
    "Glory": "lightgoldenrodyellow",
    "Failure": "rosybrown",
    "Envy": "greenyellow",
    "Lust": "crimson",
    "Wrath": "firebrick",
    "Virtue": "mintcream",
    "Sin": "darkolivegreen",
    "Fate": "plum",
    "Chance": "tan",
    "Destiny": "wheat",
    "Silence": "lightgray",
    "Sound": "mediumseagreen",
    "Vision": "lightcyan",
    "Blindness": "slategray",
    "Revelation": "lightyellow",
    "Illusion": "lavender",
    "Truthfulness": "floralwhite",
    "Deceit": "darkslategrey",
    "Trust": "cornflowerblue",
    "Suspicion": "darkgray",
    "Balance": "ghostwhite",
    "Disorder": "indigo",
    "Memory": "mistyrose",
    "Forgetfulness": "lightgray",
    "Tradition": "antiquewhite",
    "Innovation": "lightblue",
    "Curiosity": "lightseagreen",
    "Fearlessness": "goldenrod",
    "Awareness": "lightyellow",
    "Neglect": "lightslategrey",
    "Rebirth": "palegreen",
    "Decay": "sienna",
    "Calm": "lightcyan",
    "Anxiety": "tomato",
    "Security": "seashell",
    "Risk": "salmon",
    "Honor": "papayawhip",
    "Dishonor": "brown",
    "Grace": "lavenderblush",
    "Burden": "grey",
    "Clarity": "aliceblue",
    "Confusion": "mediumpurple",
    "Inspiration": "lightgoldenrodyellow",
    "Oppression": "slategray",
    "Sanity": "lightgreen",
    "Madness": "darkorchid",
    "Light": "lemonchiffon",
    "Darkness": "black",
    "Memory": "mistyrose",
    "Knowledge": "beige",
    "Belief": "lightblue",
    "Imagination": "orchid",
    "Spirituality": "mediumslateblue"
}


physical_living_elements = {
    "Fire": "red",
    "Water": "blue",
    "Earth": "saddlebrown",
    "Air": "skyblue",
    "Metal": "lightgray",
    "Crystal": "cyan",
    "Stone": "sienna",
    "Sand": "tan",
    "Mud": "burlywood",
    "Ice": "lightblue",
    "Lava": "orangered",
    "Lightning": "gold",
    "Wood": "peru",
    "Grass": "yellowgreen",
    "Leaf": "mediumseagreen",
    "Tree": "forestgreen",
    "Root": "darkolivegreen",
    "Flower": "orchid",
    "Petal": "pink",
    "Fruit": "coral",
    "Seed": "wheat",
    "Vine": "olivedrab",
    "Thorn": "darkseagreen",
    "Branch": "sienna",
    "Bark": "chocolate",
    "Sap": "goldenrod",
    "Soil": "saddlebrown",
    "Moss": "lightgreen",
    "Fungus": "plum",
    "Bacteria": "slateblue",
    "Virus": "indianred",
    "Cell": "beige",
    "Organ": "rosybrown",
    "Blood": "crimson",
    "Bone": "ivory",
    "Flesh": "salmon",
    "Muscle": "tomato",
    "Heart": "firebrick",
    "Brain": "lightcoral",
    "Nerve": "lightpink",
    "Lung": "peachpuff",
    "Skin": "navajowhite",
    "Hair": "gray",
    "Feather": "lavender",
    "Fur": "lightgray",
    "Shell": "papayawhip",
    "Claw": "sienna",
    "Horn": "tan",
    "Tail": "burlywood",
    "Beak": "gold",
    "Wing": "skyblue",
    "Eye": "blue",
    "Ear": "mistyrose",
    "Voice": "lightsteelblue",
    "Roar": "orange",
    "Scent": "lemonchiffon",
    "Paw": "sandybrown",
    "Hoof": "peru",
    "Scale": "seagreen",
    "Fin": "aqua",
    "Tentacle": "mediumorchid",
    "Web": "lightcyan",
    "Hive": "khaki",
    "Nest": "beige",
    "Egg": "ivory",
    "Larva": "palegreen",
    "Cocoon": "linen",
    "Beetle": "black",
    "Butterfly": "violet",
    "Ant": "brown",
    "Bee": "goldenrod",
    "Bird": "lightblue",
    "Fish": "deepskyblue",
    "Lizard": "darkolivegreen",
    "Snake": "darkseagreen",
    "Spider": "darkgray",
    "Frog": "mediumseagreen",
    "Wolf": "gray",
    "Bear": "saddlebrown",
    "Lion": "darkgoldenrod",
    "Tiger": "orangered",
    "Fox": "chocolate",
    "Rabbit": "white",
    "Mouse": "gainsboro",
    "Deer": "peru",
    "Horse": "sienna",
    "Cow": "cornsilk",
    "Dog": "sandybrown",
    "Cat": "lightgray",
    "Human": "bisque",
    "Spirit": "mintcream",
    "Ghost": "aliceblue",
    "Soul": "lavenderblush",
    "Breath": "honeydew",
    "Heartbeat": "lightpink",
    "Instinct": "thistle",
    "Symbiosis": "lightgreen",
    "Adaptation": "lightblue",
    "Evolution": "palegoldenrod"
}

random_weird_elements = {
    "Christmas": "red",
    "Box": "saddlebrown",
    "Engine": "dimgray",
    "Basement": "gray",
    "Constitution": "gold",
    "Stapler": "lightgray",
    "WiFi": "blue",
    "Toaster": "tan",
    "Homework": "lightpink",
    "Alarm": "crimson",
    "Pillow": "ivory",
    "Jelly": "violet",
    "Mustache": "sienna",
    "Caffeine": "darkorange",
    "Toilet": "gainsboro",
    "Meme": "hotpink",
    "Cringe": "plum",
    "Lecture": "slategray",
    "Printer": "silver",
    "Cupcake": "lightyellow",
    "Boredom": "gray",
    "Treadmill": "lightslategray",
    "Spreadsheet": "lightsteelblue",
    "Debugging": "lightgreen",
    "Latency": "khaki",
    "Inbox": "skyblue",
    "Password": "black",
    "Firewall": "firebrick",
    "Pixel": "deepskyblue",
    "Lawn": "lawngreen",
    "Pasta": "wheat",
    "Soup": "peachpuff",
    "Sandwich": "burlywood",
    "Lemonade": "lemonchiffon",
    "Umbrella": "slateblue",
    "Banana": "gold",
    "Helmet": "lightblue",
    "Shoe": "saddlebrown",
    "Guitar": "chocolate",
    "Saxophone": "goldenrod",
    "Jam": "orchid",
    "Pickle": "yellowgreen",
    "Radio": "cornflowerblue",
    "Clock": "lightgray",
    "Satellite": "silver",
    "Mirror": "aliceblue",
    "Wallet": "brown",
    "Drone": "dimgray",
    "Keyboard": "black",
    "Mousepad": "lightcoral",
    "Bookmark": "lightgoldenrodyellow",
    "Flashlight": "lightyellow",
    "Fridge": "whitesmoke",
    "Microwave": "seashell",
    "Coffee": "sienna",
    "Tea": "palegreen",
    "Donut": "lightpink",
    "Sneeze": "lightcyan",
    "Sneaker": "navajowhite",
    "Lego": "red",
    "Popcorn": "beige",
    "Trophy": "gold",
    "Keyboard": "gray",
    "Sink": "lightgray",
    "Shampoo": "lavender",
    "Mug": "sienna",
    "Towel": "lightblue",
    "Camera": "slategray",
    "Curtain": "mistyrose",
    "Bucket": "tan",
    "Plunger": "peru",
    "Spoon": "silver",
    "Fork": "gray",
    "Napkin": "linen",
    "Notebook": "khaki",
    "Charger": "black",
    "Cable": "darkgray",
    "Pancake": "bisque",
    "Toothpaste": "mintcream",
    "Suitcase": "saddlebrown",
    "Chalk": "white",
    "Door": "burlywood",
    "Window": "skyblue",
    "Curtain": "thistle",
    "Ladder": "rosybrown",
    "Battery": "yellow",
    "Oil": "olive",
    "Soda": "tomato",
    "Pop": "plum",
    "Whistle": "gold",
    "Magnet": "lightseagreen",
    "Ringtone": "pink",
    "Helmet": "lightsteelblue",
    "Sticker": "lightcyan",
    "Zipper": "dimgray",
    "Keyboard": "black",
    "Joystick": "red",
    "Legend": "orange",
    "Suprise": "yellow",
    "Chaos": "green"
}


# Predefined elements and colors
default_elements = 
    "fire": "red",
    "Water": "blue",
    "Earth": "saddlebrown",
    "Air": "skyblue",
    "Light": "lightyellow",
    "Dark": "gray",
    "Metal": "lightgray",
    "Crystal": "cyan",
    "Ice": "lightblue",
    "Lightning": "gold",
    "Steam": "gainsboro",
    "Magma": "tomato",
    "Shadow": "dimgray",
    "Holy": "ivory",
    "Poison": "yellowgreen",
    "Nature": "green",
    "Void": "purple",
    "Chaos": "orchid",
    "Order": "beige",
    "Plasma": "deeppink",
    "Wood": "peru",
    "Glass": "lavender",
    "Sand": "tan",
    "Ash": "darkgray",
    "Smoke": "slategray",
    "Aether": "mediumorchid",
    "Blood": "darkred",
    "Spirit": "mediumpurple",
    "Sound": "mediumseagreen",
    "Energy": "orange",
    "Radiance": "lightgoldenrodyellow",
    "Frost": "powderblue",
    "Corruption": "darkmagenta",
    "Dream": "thistle",
    "Gravity": "dimgray",
    "Echo": "silver",
    "Pulse": "hotpink",
    "Acid": "greenyellow",
    "Venom": "olivedrab",
    "Flame": "darkorange",
    "Mist": "whitesmoke",
    "Obsidian": "black",
    "Lava": "orangered",  # Not allowed! → change to "tomato"
    "Storm": "slategray",
    "Stone": "sienna",
    "Fog": "lightgray",
    "Quake": "rosybrown",
    "Ink": "navy",
    "Force": "slateblue",
    "Moon": "khaki",
    "Sun": "gold",
    "Star": "lightyellow",
    "Dust": "burlywood",
    "Ether": "blueviolet",
    "Spark": "darkorange",
    "Chill": "paleturquoise",
    "Metallic": "lightsteelblue",
    "Gale": "lightblue",
    "Thorn": "darkolivegreen",
    "Toxin": "yellowgreen",
    "Arcane": "mediumslateblue",
    "Blessing": "lemonchiffon",
    "Curse": "indigo",
    "Fear": "dimgray",
    "Hope": "honeydew",
    "Glory": "gold",
    "Decay": "sienna",
    "Silence": "lightgray",
    "Illusion": "lavender",
    "Reality": "beige",
    "Time": "darkgray",
    "Space": "midnightblue",
    "Memory": "mistyrose",
    "Glow": "cornsilk",
    "Rift": "blueviolet",
    "Nether": "darkslategray",
    "Specter": "lightslategray",
    "Flare": "coral",
    "Breeze": "lightcyan",
    "Haze": "lightgray",
    "Blight": "darkolivegreen",
    "Wisp": "aliceblue",
    "Tide": "steelblue",
    "Tempest": "slategray",
    "Whirlwind": "lightblue",
    "Charm": "lightpink",
    "Envy": "limegreen",
    "Greed": "darkseagreen",
    "Wrath": "firebrick",
    "Lust": "crimson",
    "Serenity": "azure",
    "Unity": "mintcream",
    "Balance": "ghostwhite",
    "Fate": "plum",
    "Truth": "ivory",
    "Myth": "thistle",
    "Shatter": "gainsboro"
}



combined_elements = {**physical_elements, **conceptual_elements, **physical_living_elements, **random_weird_elements}


# --- Element Sets ---
element_sets = {
    "Default Elements": default_elements,
    "Physical Elements": physical_elements,
    "Conceptual Elements": conceptual_elements,
    "Physical + Living Elements": physical_living_elements,
    "Random Weird Elements": random_weird_elements,
    "Combined Elements": combined_elements
}



import streamlit as st
import networkx as nx
from pyvis.network import Network
import numpy as np
import math
from itertools import combinations
from streamlit.components.v1 import html
import tempfile

# Predefined elements and colors


def generate_elemental_combinations_pyvis(pos_elms_colors, p, l, input_type, seed=None):
    if seed is not None:
        np.random.seed(seed)

    pos_elms = list(pos_elms_colors.keys())
    N = p
    n = p
    levels = [0]

    for q in range(l):
        new_v = math.comb(n, 2)
        levels.append(N)
        N += new_v
        n = new_v

    levels.append(N)
    if input_type == 'Random Elements':
        elms = np.random.choice(pos_elms, N, replace=False)
    else:
        elms = pos_elms
    elms_split = []

    for j in range(l + 1):
        elms_l = elms[levels[j]: levels[j + 1]]
        elms_split.append(elms_l)

    edges = []

    for ind in range(l):
        elm_combs = combinations(elms_split[ind], 2)
        elms_res = elms_split[ind + 1]
        for k, el in enumerate(elm_combs):
            edges.append([el[0], elms_res[k]])
            edges.append([el[1], elms_res[k]])

    G = nx.DiGraph()
    G.add_edges_from(edges)

    net = Network(notebook=False, cdn_resources='remote', directed=True)
    net.from_nx(G)

    for n in net.nodes:
        new_colour = pos_elms_colors.get(n['label'], 'gray')
        n['color'] = new_colour
        n['border'] = 'black'

    for e in net.edges:
        ecolour = pos_elms_colors.get(e['from'], 'gray')
        e['color'] = ecolour

    # Display Pyvis in Streamlit
    with tempfile.NamedTemporaryFile('w', delete=False, suffix='.html') as f:
        net.save_graph(f.name)
        html_content = open(f.name, 'r', encoding='utf-8').read()
    html(html_content, height=700, scrolling=True)

# Streamlit UI
st.set_page_config(page_title="Elemental Combination Generator", layout="centered")
st.title("🧪 Elemental Combination Graph Generator")
set_choice = st.selectbox("Choose an element set", list(element_sets.keys()))
element_colors = element_sets[set_choice]

input_type = st.radio("Choose input method:", ["Random Elements", "Custom Elements"])

if input_type == "Random Elements":
    pos_elms_colors = element_colors.copy()
else:
    custom_elements_str = st.text_input("Enter custom elements (comma-separated)", "Fire,Water,Earth,Air")
    custom_colors_str = st.text_input("Enter corresponding colors (comma-separated)", "red,blue,brown,skyblue")
    custom_elements = [e.strip().title() for e in custom_elements_str.split(",")]
    custom_colors = [c.strip().lower() for c in custom_colors_str.split(",")]

    if len(custom_elements) != len(custom_colors):
        st.error("Element and color counts must match.")
        st.stop()

    pos_elms_colors = dict(zip(custom_elements, custom_colors))

p = st.number_input("Number of base elements (p)", min_value=2, max_value=20, value=4)
l = st.number_input("Number of levels (l)", min_value=1, max_value=5, value=2)
use_seed = st.checkbox("Use Seed?")
seed_val = st.number_input("Seed", min_value=0, value=42, step=1) if use_seed else None

if st.button("Generate Graph"):
    try:
        generate_elemental_combinations_pyvis(pos_elms_colors, p, l, input_type, seed=seed_val)
        if not use_seed:
            st.info("Random seed used (not shown since unchecked).")
        else:
            st.success(f"Seed used: `{seed_val}`")
    except Exception as e:
        st.error(f"❌ Error generating graph: {e}")
        
